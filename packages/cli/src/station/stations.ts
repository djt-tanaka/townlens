/**
 * 主要駅データベース。
 * 首都圏・近畿圏・中部圏の主要駅を収録。
 * [駅名, 路線名, 緯度, 経度, 市区町村コード(任意)]
 */

import type { StationEntry } from "./types";

const STATION_DATA: ReadonlyArray<
  readonly [string, string, number, number, string?]
> = [
  // JR山手線
  ["東京", "JR山手線", 35.6812, 139.7671, "13101"],
  ["有楽町", "JR山手線", 35.6749, 139.7630, "13102"],
  ["新橋", "JR山手線", 35.6663, 139.7583, "13103"],
  ["浜松町", "JR山手線", 35.6555, 139.7569, "13103"],
  ["田町", "JR山手線", 35.6459, 139.7476, "13103"],
  ["品川", "JR山手線", 35.6285, 139.7387, "13109"],
  ["大崎", "JR山手線", 35.6197, 139.7283, "13109"],
  ["五反田", "JR山手線", 35.6265, 139.7234, "13109"],
  ["目黒", "JR山手線", 35.6337, 139.7158, "13110"],
  ["恵比寿", "JR山手線", 35.6467, 139.7101, "13113"],
  ["渋谷", "JR山手線", 35.6580, 139.7016, "13113"],
  ["原宿", "JR山手線", 35.6702, 139.7027, "13113"],
  ["代々木", "JR山手線", 35.6833, 139.7020, "13113"],
  ["新宿", "JR山手線", 35.6896, 139.7006, "13104"],
  ["新大久保", "JR山手線", 35.7012, 139.7001, "13104"],
  ["高田馬場", "JR山手線", 35.7128, 139.7036, "13104"],
  ["目白", "JR山手線", 35.7210, 139.7066, "13116"],
  ["池袋", "JR山手線", 35.7295, 139.7109, "13116"],
  ["大塚", "JR山手線", 35.7317, 139.7283, "13116"],
  ["巣鴨", "JR山手線", 35.7334, 139.7394, "13116"],
  ["駒込", "JR山手線", 35.7364, 139.7470, "13116"],
  ["田端", "JR山手線", 35.7380, 139.7610, "13117"],
  ["西日暮里", "JR山手線", 35.7320, 139.7668, "13118"],
  ["日暮里", "JR山手線", 35.7282, 139.7706, "13118"],
  ["鶯谷", "JR山手線", 35.7214, 139.7787, "13106"],
  ["上野", "JR山手線", 35.7141, 139.7774, "13106"],
  ["御徒町", "JR山手線", 35.7076, 139.7747, "13106"],
  ["秋葉原", "JR山手線", 35.6983, 139.7731, "13101"],
  ["神田", "JR山手線", 35.6917, 139.7710, "13101"],
  // JR中央線
  ["中野", "JR中央線", 35.7057, 139.6657, "13114"],
  ["荻窪", "JR中央線", 35.7040, 139.6200, "13115"],
  ["吉祥寺", "JR中央線", 35.7029, 139.5795, "13203"],
  ["三鷹", "JR中央線", 35.7027, 139.5607, "13204"],
  ["国分寺", "JR中央線", 35.7009, 139.4804, "13214"],
  ["立川", "JR中央線", 35.6980, 139.4140, "13202"],
  ["八王子", "JR中央線", 35.6560, 139.3385, "13201"],
  // JR京浜東北線・東海道線
  ["川崎", "JR京浜東北線", 35.5310, 139.6970, "14130"],
  ["横浜", "JR京浜東北線", 35.4660, 139.6223, "14100"],
  ["大船", "JR東海道線", 35.3504, 139.5339, "14204"],
  ["藤沢", "JR東海道線", 35.3388, 139.4874, "14205"],
  // 東急東横線
  ["自由が丘", "東急東横線", 35.6074, 139.6686, "13110"],
  ["武蔵小杉", "東急東横線", 35.5765, 139.6594, "14130"],
  ["日吉", "東急東横線", 35.5535, 139.6468, "14100"],
  // 東急田園都市線
  ["二子玉川", "東急田園都市線", 35.6116, 139.6263, "13112"],
  ["たまプラーザ", "東急田園都市線", 35.5770, 139.5580, "14100"],
  // 小田急線
  ["下北沢", "小田急小田原線", 35.6618, 139.6669, "13112"],
  ["町田", "小田急小田原線", 35.5424, 139.4457, "13210"],
  // 京王線
  ["調布", "京王線", 35.6518, 139.5424, "13208"],
  ["府中", "京王線", 35.6723, 139.4777, "13206"],
  // 西武池袋線
  ["練馬", "西武池袋線", 35.7382, 139.6536, "13120"],
  ["所沢", "西武池袋線", 35.7854, 139.4690, "11208"],
  // 西武新宿線
  ["高田馬場", "西武新宿線", 35.7128, 139.7036, "13104"],
  // 東京メトロ
  ["表参道", "東京メトロ銀座線", 35.6654, 139.7121, "13103"],
  ["銀座", "東京メトロ銀座線", 35.6717, 139.7641, "13102"],
  ["六本木", "東京メトロ日比谷線", 35.6636, 139.7313, "13103"],
  ["中目黒", "東京メトロ日比谷線", 35.6443, 139.6995, "13110"],
  ["赤坂", "東京メトロ千代田線", 35.6729, 139.7370, "13103"],
  ["大手町", "東京メトロ丸ノ内線", 35.6864, 139.7639, "13101"],
  ["豊洲", "東京メトロ有楽町線", 35.6554, 139.7966, "13108"],
  ["月島", "東京メトロ有楽町線", 35.6624, 139.7834, "13102"],
  // 都営地下鉄
  ["麻布十番", "都営大江戸線", 35.6554, 139.7377, "13103"],
  ["汐留", "都営大江戸線", 35.6610, 139.7613, "13103"],
  // 埼玉
  ["大宮", "JR京浜東北線", 35.9066, 139.6238, "11100"],
  ["浦和", "JR京浜東北線", 35.8583, 139.6568, "11100"],
  ["川口", "JR京浜東北線", 35.8076, 139.7217, "11203"],
  // 千葉
  ["千葉", "JR総武線", 35.6131, 140.1134, "12100"],
  ["船橋", "JR総武線", 35.7015, 139.9853, "12204"],
  ["柏", "JR常磐線", 35.8621, 139.9714, "12217"],
  ["松戸", "JR常磐線", 35.7874, 139.9011, "12207"],
  // 近畿圏
  ["大阪", "JR東海道線", 34.7025, 135.4959, "27100"],
  ["梅田", "大阪メトロ御堂筋線", 34.7047, 135.4985, "27127"],
  ["難波", "大阪メトロ御堂筋線", 34.6660, 135.5013, "27102"],
  ["天王寺", "JR大阪環状線", 34.6467, 135.5139, "27109"],
  ["京橋", "JR大阪環状線", 34.6964, 135.5356, "27128"],
  ["新大阪", "JR東海道新幹線", 34.7329, 135.5001, "27123"],
  ["三ノ宮", "JR東海道線", 34.6933, 135.1957, "28100"],
  ["京都", "JR東海道線", 34.9858, 135.7588, "26100"],
  ["奈良", "JR関西本線", 34.6802, 135.8182, "29201"],
  // 中部圏
  ["名古屋", "JR東海道線", 35.1709, 136.8815, "23100"],
  ["栄", "名古屋メトロ東山線", 35.1681, 136.9083, "23106"],
  ["金山", "JR中央線", 35.1445, 136.9001, "23105"],
  // 九州
  ["博多", "JR鹿児島本線", 33.5898, 130.4207, "40130"],
  ["天神", "福岡市営地下鉄", 33.5893, 130.3990, "40130"],
  // 北海道
  ["札幌", "JR函館本線", 43.0687, 141.3508, "01100"],
  ["大通", "札幌市営地下鉄", 43.0595, 141.3546, "01101"],
  // 東北
  ["仙台", "JR東北本線", 38.2600, 140.8825, "04100"],
  // 北陸
  ["金沢", "JR北陸本線", 36.5780, 136.6480, "17201"],
  // 新幹線主要駅
  ["品川", "JR東海道新幹線", 35.6285, 139.7387, "13109"],
  ["静岡", "JR東海道新幹線", 34.9714, 138.3888, "22100"],
  ["浜松", "JR東海道新幹線", 34.7048, 137.7346, "22130"],
  ["広島", "JR山陽新幹線", 34.3963, 132.4752, "34100"],
  ["岡山", "JR山陽新幹線", 34.6650, 133.9181, "33100"],
];

/** 駅名 → StationEntry[] の逆引きマップ（初回アクセス時に構築） */
let stationMap: ReadonlyMap<string, ReadonlyArray<StationEntry>> | null = null;

function buildStationMap(): ReadonlyMap<string, ReadonlyArray<StationEntry>> {
  const map = new Map<string, StationEntry[]>();

  for (const [name, lineName, lat, lng, areaCode] of STATION_DATA) {
    const entry: StationEntry = { name, lineName, lat, lng, areaCode };
    const existing = map.get(name);
    if (existing) {
      existing.push(entry);
    } else {
      map.set(name, [entry]);
    }
  }

  return map;
}

/** 駅名で検索する（完全一致） */
export function findStationByName(
  name: string,
): ReadonlyArray<StationEntry> {
  if (stationMap === null) {
    stationMap = buildStationMap();
  }
  return stationMap.get(name) ?? [];
}

/** 全駅名のリストを返す（重複なし） */
export function getAllStationNames(): ReadonlyArray<string> {
  if (stationMap === null) {
    stationMap = buildStationMap();
  }
  return [...stationMap.keys()];
}

/** 登録駅数を返す */
export function getStationCount(): number {
  return STATION_DATA.length;
}
